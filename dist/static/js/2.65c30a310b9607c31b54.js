webpackJsonp([2],{"1Bte":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABO0lEQVRYR+2VwUrEMBCGZ/I4evFpFARB8CAIomDmTz2IKyhsu0UQBMGDIAiCb+ID6OOkUlhl7U7bZJduL8kxCfm+/EkmTCM3HplPSSAlkBLYSAJlWW557++YeSoin4tPf3CBOfyDiLZrMIB/zEEFmnBmnojIzUYSaMKJ6ArAbbPyDpKAAr8EMNXK/pJAURQ7RHRmjJlZa79j/4omvKoqOOdmbetoAtV88pcxZjdGQjnzCxG579rEkkCe5xNmvo6VUGI/B/DQl6B6B2IllNhPnXOPffB6vPUShkooOz8B8BQC7xSoB/skFPgxgOdQeK9Al4QCPwLwEgMPEmiT8N7/lVdjzKG19jUWHiygSfzWdmY+EJG3VeBRAopE3bUP4H1VeLTAooT3fi/LsvoY1mqD/AUxRkkgJZASGD2BH1MBqyGCzpjAAAAAAElFTkSuQmCC"},F74f:function(t,e){},WQ1L:function(t,e){},YZ11:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),i=a.n(s),l=a("woOf"),r=a.n(l),o=a("Dd8w"),n=a.n(o),c=a("mtWM"),d=a.n(c),u=a("mw3O"),m=a.n(u),v=a("y7k7");d.a.defaults.baseURL=v.a,d.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded";var p=function(t,e){return d.a.post("/crmThreadManage/searchDetial",m.a.stringify(n()({},t))).then(function(t){e(t)}).catch(function(){})},f=function(t,e){return d.a.get("/crmSource/searchAll",{params:t}).then(function(t){e(t)}).catch(function(){})},h=function(t,e){return d.a.post("/crmRelatedPerson/searchByThreadId",m.a.stringify(n()({},t))).then(function(t){e(t)}).catch(function(){})},_={name:"addclue",components:{},props:["dataFormVisible","dataForm","relatelist","states","sorts","sourceList","isType"],data:function(){return{role:[],roleList:[{value:1,name:"决策者"},{value:2,name:"影响者"},{value:3,name:"执行者"},{value:4,name:"使用者"}],addimg:"./static/images/add.png",closeimg:"./static/images/close.png",ratateVisible:!1,ralateForm:{},ralateTitle:"",btnRalateWord:"",ralateType:0,index:0}},created:function(){},watch:{dataFormVisible:function(t,e){this.$emit("update:dataFormVisible",t)},dataForm:function(t,e){this.$emit("update:dataForm",t)},relatelist:function(t,e){this.$emit("update:relatelist",t)},ratateVisible:function(t,e){this.$emit("update:ratateVisible",t)},sourceList:function(t,e){this.$emit("update:sourceList",t)}},methods:{stateChange:function(){this.$forceUpdate(),this.dataForm.stateId;for(var t=0;t<this.states.length;t++)if(this.dataForm.stateId==this.states[t].id){this.dataForm.frequence=this.states[t].frequence;break}},getSourceAllList:function(){var t=this;f("",function(e){null==e.data.obj?t.sourceList=[]:t.sourceList=e.data.obj})},changeAddSource:function(){var t=this;this.$forceUpdate();var e,a,s={sourceName:this.dataForm.sourceName};e=s,a=function(e){t.$message({message:"添加成功",type:"success"})},d.a.post("/crmSource/addSource",m.a.stringify(n()({},e))).then(function(t){a(t)}).catch(function(){})},onlyNumber:function(){this.dataForm.frequence=this.dataForm.frequence.replace(/[^\.\d]/g,""),this.dataForm.frequence=this.dataForm.frequence.replace(".","")},ageNumber:function(){this.ralateForm.age=this.ralateForm.age.replace(/[^\.\d]/g,""),this.ralateForm.age=this.ralateForm.age.replace(".","")},addRelate:function(){this.ratateVisible=!0,this.ralateTitle="添加相关人",this.btnRalateWord="添加",this.ralateForm={},this.ralateType=1,this.role=[]},editRalate:function(t){this.index=t,this.ralateForm=r()({},this.relatelist[t]),""==this.relatelist[t].customerRole?this.role=[]:this.role=this.relatelist[t].customerRole.split(","),this.ralateTitle="编辑相关人",this.btnRalateWord="保存",this.ralateType=2,this.ratateVisible=!0},delRelate:function(t){"add"==this.isType?this.relatelist.splice(t,1):"edit"==this.isType&&(this.relatelist[t].status=2)},submitRalateForm:function(){if(1===this.ralateType){var t=r()({},this.ralateForm);t.customerRole=this.role.join(","),t.status=1,this.relatelist.push(t),this.ratateVisible=!1}else if(2===this.ralateType){var e=r()({},this.ralateForm);e.customerRole=this.role.join(","),this.relatelist.splice(this.index,1,e),this.ratateVisible=!1}},selectChange:function(){this.$forceUpdate()}}},b={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"addcluebox"},[a("el-form",{ref:"dataForm",attrs:{size:"small",model:t.dataForm,"label-width":"142px"}},[a("el-form-item",{attrs:{label:"商机名称：",prop:"businessName",rules:[{required:!0,message:"请填写商机名称",trigger:"blur"}]}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写商机名称"},model:{value:t.dataForm.businessName,callback:function(e){t.$set(t.dataForm,"businessName",e)},expression:"dataForm.businessName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"项目地点：",prop:"adress",rules:[{required:!0,message:"请填写项目地点",trigger:"blur"}]}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写项目地点"},model:{value:t.dataForm.adress,callback:function(e){t.$set(t.dataForm,"adress",e)},expression:"dataForm.adress"}})],1),t._v(" "),a("div",{staticClass:"flexbox"},[a("el-form-item",{staticClass:"select-block flexitem",attrs:{label:"商机分类：",prop:"categoryId",rules:[{required:!0,message:"请选择商机分类",trigger:"blur"}]}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择商机分类"},on:{change:t.selectChange},model:{value:t.dataForm.categoryId,callback:function(e){t.$set(t.dataForm,"categoryId",e)},expression:"dataForm.categoryId"}},t._l(t.sorts,function(t){return a("el-option",{key:t.id,attrs:{label:t.categoryName,value:t.id}})}))],1),t._v(" "),a("el-form-item",{staticClass:"select-block flexitem",attrs:{label:"商机状态：",prop:"stateId",rules:[{required:!0,message:"请选择商机状态",trigger:"blur"}]}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择商机状态"},on:{change:function(e){t.stateChange()}},model:{value:t.dataForm.stateId,callback:function(e){t.$set(t.dataForm,"stateId",e)},expression:"dataForm.stateId"}},t._l(t.states,function(t){return a("el-option",{key:t.id,attrs:{label:t.stateName,value:t.id}})}))],1)],1),t._v(" "),a("div",{staticClass:"flexbox"},[a("el-form-item",{staticClass:"select-block flexitem",attrs:{label:"商机来源：",prop:"sourceName"}},[a("el-select",{attrs:{filterable:"",clearable:"","allow-create":"",placeholder:"请选择商机来源"},on:{change:t.changeAddSource,focus:t.getSourceAllList},model:{value:t.dataForm.sourceName,callback:function(e){t.$set(t.dataForm,"sourceName",e)},expression:"dataForm.sourceName"}},t._l(t.sourceList,function(t){return a("el-option",{key:t.id,attrs:{label:t.sourceName,value:t.sourceName}})}))],1),t._v(" "),a("el-form-item",{staticClass:"flexitem input-remark",attrs:{label:"拜访频率：",prop:"frequence"}},[a("el-input",{staticClass:"visitrate",attrs:{"auto-complete":"off",placeholder:"请输入天数"},nativeOn:{keyup:function(e){return t.onlyNumber(e)}},model:{value:t.dataForm.frequence,callback:function(e){t.$set(t.dataForm,"frequence",e)},expression:"dataForm.frequence"}},[a("template",{slot:"prepend"},[t._v("间隔")]),t._v(" "),a("template",{slot:"append"},[t._v("天拜访")])],2)],1)],1),t._v(" "),a("div",{staticClass:"flexbox"},[a("el-form-item",{staticClass:"flexitem",attrs:{label:"项目预计开标时间：",prop:"tenderTime"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择预计开标时间","default-time":"09:00:00"},on:{change:t.selectChange},model:{value:t.dataForm.tenderTime,callback:function(e){t.$set(t.dataForm,"tenderTime",e)},expression:"dataForm.tenderTime"}})],1),t._v(" "),a("el-form-item",{staticClass:"flexitem",attrs:{label:"预计实现毛利：",prop:"grossMargin"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写预计实现毛利"},model:{value:t.dataForm.grossMargin,callback:function(e){t.$set(t.dataForm,"grossMargin",e)},expression:"dataForm.grossMargin"}},[a("template",{slot:"append"},[t._v("元")])],2)],1)],1),t._v(" "),a("div",{staticClass:"flexbox"},[a("el-form-item",{staticClass:"flexitem",attrs:{label:"预计中标金额：",prop:"bidAmount"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写预计中标金额"},model:{value:t.dataForm.bidAmount,callback:function(e){t.$set(t.dataForm,"bidAmount",e)},expression:"dataForm.bidAmount"}},[a("template",{slot:"append"},[t._v("元")])],2)],1),t._v(" "),a("el-form-item",{staticClass:"flexitem",attrs:{label:"项目建模预算：",prop:"modelBudget"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写项目建模预算"},model:{value:t.dataForm.modelBudget,callback:function(e){t.$set(t.dataForm,"modelBudget",e)},expression:"dataForm.modelBudget"}},[a("template",{slot:"append"},[t._v("元")])],2)],1)],1),t._v(" "),a("div",{staticClass:"relatebox"},[a("p",{staticClass:"tt"},[t._v("相关人：")]),t._v(" "),a("div",{staticClass:"relatelist"},[t._l(t.relatelist,function(e,s){return a("el-tooltip",{key:s,attrs:{effect:"dark",placement:"top-start"}},[a("div",{staticStyle:{"max-width":"300px","line-height":"2"},attrs:{slot:"content"},slot:"content"},[a("p",{staticStyle:{"font-size":"14px","font-weight":"bold"}},[t._v("客户信息")]),t._v(" "),a("p",[t._v("客户姓名："+t._s(e.name))]),t._v(" "),a("p",[t._v("年龄："+t._s(e.age))]),t._v(" "),"1"==e.gender?a("p",[t._v("性别：男")]):"2"==e.gender?a("p",[t._v("性别：女")]):a("p",[t._v("性别：")]),t._v(" "),a("p",[t._v("客户职位："+t._s(e.job))]),t._v(" "),a("p",[t._v("上级领导："+t._s(e.leadership))]),t._v(" "),a("p",[t._v("客户电话："+t._s(e.phone))]),t._v(" "),a("p",[t._v("客户角色："+t._s(e.customerRole))]),t._v(" "),a("p",[t._v("情况说明："+t._s(e.explains))])]),t._v(" "),a("a",{staticClass:"item",style:2==e.status?"display:none":"",attrs:{href:"javascript:;"}},[a("span",{on:{click:function(e){t.editRalate(s)}}},[t._v(t._s(e.name))]),t._v(" "),a("img",{attrs:{src:t.closeimg,alt:""},on:{click:function(e){t.delRelate(s)}}})])])}),t._v(" "),a("a",{staticClass:"addbtn",attrs:{href:"javascript:;"},on:{click:t.addRelate}},[a("img",{attrs:{src:t.addimg,alt:""}})])],2)])],1),t._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:t.ralateTitle,visible:t.ratateVisible,width:"700px","append-to-body":""},on:{"update:visible":function(e){t.ratateVisible=e}}},[a("el-form",{ref:"ralateForm",attrs:{size:"small",model:t.ralateForm,"label-width":"100px"}},[a("div",{staticClass:"flexbox"},[a("el-form-item",{staticClass:"flexitem",attrs:{label:"客户姓名：",prop:"name",rules:[{required:!0,message:"请填写客户姓名",trigger:"change"}]}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写客户姓名"},model:{value:t.ralateForm.name,callback:function(e){t.$set(t.ralateForm,"name",e)},expression:"ralateForm.name"}})],1),t._v(" "),a("el-form-item",{staticClass:"flexitem",attrs:{label:"年龄：",prop:"age"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写客户职位"},nativeOn:{keyup:function(e){return t.ageNumber(e)}},model:{value:t.ralateForm.age,callback:function(e){t.$set(t.ralateForm,"age",e)},expression:"ralateForm.age"}})],1)],1),t._v(" "),a("div",{staticClass:"flexbox"},[a("el-form-item",{staticClass:"flexitem",attrs:{label:"客户电话：",prop:"phone"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写客户电话"},model:{value:t.ralateForm.phone,callback:function(e){t.$set(t.ralateForm,"phone",e)},expression:"ralateForm.phone"}})],1),t._v(" "),a("el-form-item",{staticClass:"flexitem",attrs:{label:"性别：",prop:"gender"}},[a("el-radio-group",{model:{value:t.ralateForm.gender,callback:function(e){t.$set(t.ralateForm,"gender",e)},expression:"ralateForm.gender"}},[a("el-radio",{attrs:{label:1}},[t._v("男")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("女")])],1)],1)],1),t._v(" "),a("div",{staticClass:"flexbox"},[a("el-form-item",{staticClass:"flexitem",attrs:{label:"客户职位：",prop:"job"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写客户职位"},model:{value:t.ralateForm.job,callback:function(e){t.$set(t.ralateForm,"job",e)},expression:"ralateForm.job"}})],1),t._v(" "),a("el-form-item",{staticClass:"flexitem",attrs:{label:"上级领导：",prop:"leadership"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:"请填写客户上级领导"},model:{value:t.ralateForm.leadership,callback:function(e){t.$set(t.ralateForm,"leadership",e)},expression:"ralateForm.leadership"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"客户角色：",prop:"role"}},[a("el-select",{attrs:{clearable:"",multiple:"","collapse-tags":"",placeholder:"请选择客户在本项目的决策角色"},on:{change:t.selectChange},model:{value:t.role,callback:function(e){t.role=e},expression:"role"}},t._l(t.roleList,function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.name}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"情况说明：",prop:"explains"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2},"auto-complete":"off",placeholder:"对该项目作用顿号、商务关系情况、项目跟进情况总结"},model:{value:t.ralateForm.explains,callback:function(e){t.$set(t.ralateForm,"explains",e)},expression:"ralateForm.explains"}})],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.ratateVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.submitRalateForm()}}},[t._v(t._s(t.btnRalateWord))])],1)],1)],1)},staticRenderFns:[]};var g=a("VU/8")(_,b,!1,function(t){a("WQ1L")},"data-v-50eb06a6",null).exports,C={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"detailbox"},[a("el-row",{staticClass:"wrap",attrs:{gutter:20}},[a("el-col",{attrs:{span:16}},[a("el-form",{ref:"clueDetailForm",attrs:{size:"small",model:t.clueDetailForm,"label-width":"142px"}},[a("el-form-item",{attrs:{label:"商机名称：",prop:"businessName"}},[a("el-input",{attrs:{readonly:"",placeholder:"未填写"},model:{value:t.clueDetailForm.businessName,callback:function(e){t.$set(t.clueDetailForm,"businessName",e)},expression:"clueDetailForm.businessName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"项目地点：",prop:"adress"}},[a("el-input",{attrs:{readonly:"",placeholder:"未填写"},model:{value:t.clueDetailForm.adress,callback:function(e){t.$set(t.clueDetailForm,"adress",e)},expression:"clueDetailForm.adress"}})],1),t._v(" "),a("div",{staticClass:"flexbox"},[a("el-form-item",{staticClass:"flexitem",attrs:{label:"商机分类：",prop:"categoryName"}},[a("el-input",{attrs:{readonly:"",placeholder:"未填写"},model:{value:t.clueDetailForm.categoryName,callback:function(e){t.$set(t.clueDetailForm,"categoryName",e)},expression:"clueDetailForm.categoryName"}})],1),t._v(" "),a("el-form-item",{staticClass:"flexitem",attrs:{label:"商机状态：",prop:"stateName"}},[a("el-input",{attrs:{readonly:"",placeholder:"未填写"},model:{value:t.clueDetailForm.stateName,callback:function(e){t.$set(t.clueDetailForm,"stateName",e)},expression:"clueDetailForm.stateName"}})],1)],1),t._v(" "),a("div",{staticClass:"flexbox"},[a("el-form-item",{staticClass:"flexitem",attrs:{label:"商机来源：",prop:"sourceName"}},[a("el-input",{attrs:{readonly:"",placeholder:"未填写"},model:{value:t.clueDetailForm.sourceName,callback:function(e){t.$set(t.clueDetailForm,"sourceName",e)},expression:"clueDetailForm.sourceName"}})],1),t._v(" "),a("el-form-item",{staticClass:"flexitem",attrs:{label:"拜访频率：",prop:"frequence"}},[a("el-input",{attrs:{readonly:"",placeholder:"未填写"},model:{value:t.clueDetailForm.frequence,callback:function(e){t.$set(t.clueDetailForm,"frequence",e)},expression:"clueDetailForm.frequence"}},[a("template",{slot:"prepend"},[t._v("每隔")]),t._v(" "),a("template",{slot:"append"},[t._v("天")])],2)],1)],1),t._v(" "),a("div",{staticClass:"flexbox"},[a("el-form-item",{staticClass:"flexitem",attrs:{label:"项目预计开标时间：",prop:"tenderTime"}},[a("el-date-picker",{attrs:{type:"datetime",readonly:"",placeholder:"未填写"},model:{value:t.clueDetailForm.tenderTime,callback:function(e){t.$set(t.clueDetailForm,"tenderTime",e)},expression:"clueDetailForm.tenderTime"}})],1),t._v(" "),a("el-form-item",{staticClass:"flexitem",attrs:{label:"预计实现毛利：",prop:"grossMargin"}},[a("el-input",{attrs:{readonly:"",placeholder:"未填写"},model:{value:t.clueDetailForm.grossMargin,callback:function(e){t.$set(t.clueDetailForm,"grossMargin",e)},expression:"clueDetailForm.grossMargin"}})],1)],1),t._v(" "),a("div",{staticClass:"flexbox"},[a("el-form-item",{staticClass:"flexitem",attrs:{label:"预计中标金额：",prop:"bidAmount"}},[a("el-input",{attrs:{readonly:"",placeholder:"未填写"},model:{value:t.clueDetailForm.bidAmount,callback:function(e){t.$set(t.clueDetailForm,"bidAmount",e)},expression:"clueDetailForm.bidAmount"}})],1),t._v(" "),a("el-form-item",{staticClass:"flexitem",attrs:{label:"项目建模预算：",prop:"modelBudget"}},[a("el-input",{attrs:{readonly:"",placeholder:"未填写"},model:{value:t.clueDetailForm.modelBudget,callback:function(e){t.$set(t.clueDetailForm,"modelBudget",e)},expression:"clueDetailForm.modelBudget"}})],1)],1),t._v(" "),a("div",{staticClass:"relatebox"},[a("p",{staticClass:"tt"},[t._v("相关人：")]),t._v(" "),a("div",{staticClass:"relatelist"},[0==t.relatelistDetail.length?a("p",[t._v("无")]):a("div",t._l(t.relatelistDetail,function(e,s){return a("el-tooltip",{key:s,attrs:{effect:"dark",placement:"top-start"}},[a("div",{staticStyle:{"max-width":"300px","line-height":"2"},attrs:{slot:"content"},slot:"content"},[a("p",{staticStyle:{"font-size":"14px","font-weight":"bold"}},[t._v("客户信息")]),t._v(" "),a("p",[t._v("客户姓名："+t._s(e.name))]),t._v(" "),a("p",[t._v("年龄："+t._s(e.age))]),t._v(" "),"1"==e.gender?a("p",[t._v("性别：男")]):"2"==e.gender?a("p",[t._v("性别：女")]):a("p",[t._v("性别：")]),t._v(" "),a("p",[t._v("客户职位："+t._s(e.job))]),t._v(" "),a("p",[t._v("上级领导："+t._s(e.leadership))]),t._v(" "),a("p",[t._v("客户电话："+t._s(e.phone))]),t._v(" "),a("p",[t._v("客户角色："+t._s(e.customerRole))]),t._v(" "),a("p",[t._v("情况说明："+t._s(e.explains))])]),t._v(" "),a("a",{staticClass:"item",attrs:{href:"javascript:;"}},[t._v(t._s(e.name))])])}))])])],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"visit-box"},[a("p",{staticClass:"tt"},[t._v("拜访记录详情")]),t._v(" "),a("div",{staticClass:"visitwrap"},[0==t.visitList.length?a("p",[t._v("无")]):a("div",t._l(t.visitList,function(e,s){return a("el-tooltip",{key:s,attrs:{effect:"dark",placement:"top-start"}},[a("div",{staticClass:"toolbox",staticStyle:{"line-height":"1.7","max-width":"300px",color:"#ccc"},attrs:{slot:"content"},slot:"content"},[a("p",{staticStyle:{"margin-bottom":"6px"}},[t._v("\n                  客户姓名：\n                  "),t._l(e.visitUserList,function(e){return a("span",{key:e.id,staticStyle:{color:"#fafafa","margin-right":"10px"}},[t._v(t._s(e.name))])})],2),t._v(" "),a("p",{staticStyle:{"margin-bottom":"6px"}},[t._v("\n                  拜访时间：\n                  "),a("span",{staticStyle:{color:"#fafafa"}},[t._v(t._s(t._f("dateformat")(e.visitTime,"YYYY-MM-DD")))])]),t._v(" "),a("p",{staticStyle:{"margin-bottom":"6px"}},[t._v("\n                  下次拜访时间：\n                  "),a("span",{staticStyle:{color:"#fafafa"}},[t._v(t._s(t._f("dateformat")(e.nextTime,"YYYY-MM-DD")))])]),t._v(" "),a("p",{staticStyle:{"margin-bottom":"6px"}},[t._v("\n                  申请协助：\n                  "),t._l(e.helpList,function(e){return a("span",{key:e.id,staticStyle:{color:"#fafafa","margin-right":"10px"}},[t._v(t._s(e.name))])})],2),t._v(" "),a("p",{staticStyle:{"margin-bottom":"6px"}},[t._v("\n                  拜访目的：\n                  "),a("span",{staticStyle:{color:"#fafafa"}},[t._v(t._s(e.visitAim))])]),t._v(" "),a("p",{staticStyle:{"margin-bottom":"6px"}},[t._v("\n                  客户要求：\n                  "),a("span",{staticStyle:{color:"#fafafa"}},[t._v(t._s(e.customerRequire))])]),t._v(" "),a("p",{staticStyle:{"margin-bottom":"6px"}},[t._v("\n                  下步计划：\n                  "),a("span",{staticStyle:{color:"#fafafa"}},[t._v(t._s(e.nextPlan))])]),t._v(" "),a("p",{staticStyle:{"margin-bottom":"6px"}},[t._v("\n                  待协调解决：\n                  "),a("span",{staticStyle:{color:"#fafafa"}},[t._v(t._s(e.dealThing))])])]),t._v(" "),a("div",{staticClass:"list"},[a("p",{staticClass:"num"},[t._v(t._s(s+1))]),t._v(" "),a("div",{staticClass:"con"},[a("p",[a("span",[t._v("客户姓名：")]),t._v(" "),t._l(e.visitUserList,function(e){return a("i",{key:e.id},[t._v(t._s(e.name))])})],2),t._v(" "),a("p",[a("span",[t._v("拜访时间：")]),t._v("\n                    "+t._s(t._f("dateformat")(e.visitTime,"YYYY-MM-DD"))+"\n                  ")]),t._v(" "),a("p",[a("span",[t._v("待协调解决：")]),t._v("\n                    "+t._s(e.dealThing)+"\n                  ")])])])])}))])])])],1)],1)},staticRenderFns:[]};var F=a("VU/8")({name:"detailClue",components:{},props:["detailClueVisible","clueDetailForm","relatelistDetail","visitList"],data:function(){return{}},created:function(){},watch:{detailClueVisible:function(t,e){this.$emit("update:detailClueVisible",t)}},methods:{}},C,!1,function(t){a("pKHR")},null,null).exports,x={name:"visitRecord",components:{},props:["visitRecordVisible","visitForm","userid","helpList","cusNameList","clueid"],data:function(){return{addUserShow:!1,customerName:"",closeimg:"./static/images/close.png",helpVisible:!1,departments:[],backgroundBg:{backgroundImage:"url("+a("dwq1")+")"},checkAll:!1,checkedHelper:[],helpers:[],isIndeterminate:!1,curIndex:-1,alluser:[]}},created:function(){},watch:{visitRecordVisible:function(t,e){this.$emit("update:visitRecordVisible",t)},visitForm:function(t,e){this.$emit("update:visitForm",t)}},methods:{getAllRalateList:function(){var t=this;h({threadId:this.clueid},function(e){null==e.data.obj?t.cusNameList=[]:t.cusNameList=e.data.obj})},addCustomerName:function(){this.getAllRalateList()},handleCheckedHelperChange:function(t){var e=t.length;this.checkAll=e===this.helpers.length},delPeople:function(t){this.helpList.splice(t,1)},addHelper:function(){var t,e,a=this;this.checkedHelper=[],this.helpVisible=!0,this.curIndex=-1,this.helpers=[],this.alluser=[],t={userId:this.userid},e=function(t){if(null==t.data.obj)a.departments=[],a.alluser=[];else if(a.departments=t.data.obj,0==a.departments.length)a.alluser=[];else{for(var e=0;e<a.departments.length;e++)if(null==a.departments[e].userList);else for(var s=a.departments[e].userList,i=0;i<s.length;i++)a.alluser.push(s[i]);console.log(a.alluser)}},d.a.post("/sysdept/constructDeptMsg",m.a.stringify(n()({},t))).then(function(t){e(t)}).catch(function(){})},searchUser:function(t,e){this.curIndex=e;for(var a=0;a<this.departments.length;a++)if(this.departments[a].id==t){null==this.departments[a].userList?this.helpers=[]:this.helpers=this.departments[a].userList;break}},submitHelpForm:function(){if(0==this.checkedHelper.length)this.helpList=[];else for(var t=0;t<this.checkedHelper.length;t++)for(var e=0;e<this.alluser.length;e++)this.checkedHelper[t]==this.alluser[e].id&&this.helpList.push(this.alluser[e]);this.helpVisible=!1,console.log(this.helpList)},selectChange:function(){this.$forceUpdate()}}},k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"visit-record"},[a("el-form",{ref:"visitForm",attrs:{size:"small",model:t.visitForm,"label-width":"110px"}},[a("div",{staticClass:"addflexbox"},[a("el-form-item",{attrs:{label:"客户姓名：",prop:"visitId",rules:[{required:!0,message:"请填写客户姓名",trigger:"change"}]}},[a("el-select",{attrs:{filterable:"",clearable:"",multiple:"","collapse-tags":"",placeholder:"可多选",rules:[{required:!0,message:"请填写客户姓名",trigger:"change"}]},on:{change:t.selectChange},model:{value:t.visitForm.visitId,callback:function(e){t.$set(t.visitForm,"visitId",e)},expression:"visitForm.visitId"}},t._l(t.cusNameList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("div",{staticClass:"jiabtn"},[a("i",{staticClass:"icon el-icon-circle-plus",on:{click:function(e){t.addUserShow=!0}}}),t._v(" "),t.addUserShow?a("div",{staticClass:"awrap"},[a("p",[t._v("新增客户")]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入客户姓名"},model:{value:t.customerName,callback:function(e){t.customerName=e},expression:"customerName"}}),t._v(" "),a("div",{staticClass:"buttons"},[a("el-button",{on:{click:function(e){t.addUserShow=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.addCustomerName}},[t._v("确定")])],1)],1):t._e()])],1),t._v(" "),a("el-form-item",{attrs:{label:"申请协助："}},[a("div",{staticClass:"peoples"},[t._l(t.helpList,function(e,s){return a("a",{key:s,staticClass:"item",attrs:{href:"javascript:;"}},[a("span",[t._v(t._s(e.name))]),t._v(" "),a("img",{attrs:{src:t.closeimg,alt:""},on:{click:function(e){t.delPeople(s)}}})])}),t._v(" "),a("a",{staticClass:"icon el-icon-circle-plus additem",attrs:{href:"javascript:;"},on:{click:function(e){t.addHelper()}}})],2)]),t._v(" "),a("div",{staticClass:"flexbox"},[a("el-form-item",{staticClass:"flexitem",attrs:{label:"本次拜访时间：",prop:"visitTime"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择本次拜访时间",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","default-time":"12:00:00"},model:{value:t.visitForm.visitTime,callback:function(e){t.$set(t.visitForm,"visitTime",e)},expression:"visitForm.visitTime"}})],1),t._v(" "),a("el-form-item",{staticClass:"flexitem",attrs:{label:"下次拜访时间：",prop:"nextTime"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择下次拜访时间",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","default-time":"12:00:00"},model:{value:t.visitForm.nextTime,callback:function(e){t.$set(t.visitForm,"nextTime",e)},expression:"visitForm.nextTime"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"拜访目的：",prop:"visitAim"}},[a("el-input",{attrs:{placeholder:"请填写拜访目的"},model:{value:t.visitForm.visitAim,callback:function(e){t.$set(t.visitForm,"visitAim",e)},expression:"visitForm.visitAim"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"客户要求：",prop:"customerRequire"}},[a("el-input",{attrs:{placeholder:"请填写客户要求"},model:{value:t.visitForm.customerRequire,callback:function(e){t.$set(t.visitForm,"customerRequire",e)},expression:"visitForm.customerRequire"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"下步工作计划：",prop:"nextPlan"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"请填写下步工作计划"},model:{value:t.visitForm.nextPlan,callback:function(e){t.$set(t.visitForm,"nextPlan",e)},expression:"visitForm.nextPlan"}})],1),t._v(" "),a("el-form-item",{staticClass:"set-lh",attrs:{label:"需我公司协调解决事宜：",prop:"dealThing"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"请填写需我公司协调解决事宜"},model:{value:t.visitForm.dealThing,callback:function(e){t.$set(t.visitForm,"dealThing",e)},expression:"visitForm.dealThing"}})],1)],1),t._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"邀请协助成员",visible:t.helpVisible,width:"600px","append-to-body":""},on:{"update:visible":function(e){t.helpVisible=e}}},[a("div",{staticClass:"helpbox"},[a("div",{staticClass:"box"},[a("div",{staticClass:"list"},t._l(t.departments,function(e,s){return a("p",{key:s,staticClass:"item",class:s==t.curIndex?"on":"",style:t.backgroundBg,on:{click:function(a){t.searchUser(e.id,s)}}},[t._v(t._s(e.name))])}))]),t._v(" "),a("div",{staticClass:"box box2"},[a("el-checkbox-group",{on:{change:t.handleCheckedHelperChange},model:{value:t.checkedHelper,callback:function(e){t.checkedHelper=e},expression:"checkedHelper"}},t._l(t.helpers,function(e){return a("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.name))])}))],1)]),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.helpVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.submitHelpForm()}}},[t._v("确定")])],1)])],1)},staticRenderFns:[]};var w=a("VU/8")(x,k,!1,function(t){a("el4L")},null,null).exports,y={name:"clueview",components:{visitRecord:w},props:["followData","chanceData","winOrderData","overData","states","clueid"],data:function(){return{visitimg:"../../../static/images/plan.png",changeimg:"../../../static/images/xia2.png",visitRecordVisible:!1,visitForm:{},chanceStateVisible:!1,followStateVisible:!1,winStateVisible:!1,overStateVisible:!1,backgroundDiv:{backgroundImage:"url("+a("1Bte")+")"},newclueid:this.clueid}},created:function(){},watch:{followData:function(t,e){this.$emit("update:followData",t)},chanceData:function(t,e){this.$emit("update:chanceData",t)},winOrderData:function(t,e){this.$emit("update:winOrderData",t)},overData:function(t,e){this.$emit("update:overData",t)}},methods:{handleDetailClue:function(t){this.newclueid=t,this.$emit("detailclue-event",t)},addClueView:function(){this.$emit("addclue-event")},changeChanceState:function(){this.chanceStateVisible=!1},changeFollowState:function(){this.followStateVisible=!1},changeWinState:function(){this.winStateVisible=!1},changeOverState:function(){this.overStateVisible=!1},handleVisitRecord:function(t,e){this.visitRecordVisible=!0},submitVisitRecord:function(){this.visitRecordVisible=!1}}},D={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"clueview"},[a("div",{staticClass:"listwrap"},[t._m(0),t._v(" "),t._l(t.chanceData,function(e,s){return a("div",{key:s,staticClass:"box"},[a("div",{staticClass:"tt1"},[a("div",{staticClass:"ww"},[a("el-popover",{attrs:{placement:"bottom",width:"150",trigger:"click"},model:{value:t.chanceStateVisible,callback:function(e){t.chanceStateVisible=e},expression:"chanceStateVisible"}},[a("div",{staticClass:"statelist"},t._l(t.states,function(s,i){return a("a",{key:i,class:e.status==i?"on":"",style:e.status==i?t.backgroundDiv:"",attrs:{href:"javascript:;"},on:{click:t.changeChanceState}},[t._v(t._s(s.name))])})),t._v(" "),a("a",{staticClass:"changebtn",attrs:{slot:"reference",href:"javascript:;"},slot:"reference"},[a("img",{attrs:{src:t.changeimg,alt:""}})])]),t._v(" "),a("p",{on:{click:function(a){t.handleDetailClue(e.id)}}},[t._v(t._s(e.projectname))])],1),t._v(" "),a("a",{staticClass:"visitbtn",attrs:{href:"javascript:;"},on:{click:t.handleVisitRecord}},[a("img",{attrs:{src:t.visitimg,alt:""}})])]),t._v(" "),a("div",{staticClass:"tt2"},[a("span",[t._v(t._s(e.name))]),t._v(" "),a("span",[t._v(t._s(e.phone))])]),t._v(" "),a("div",{staticClass:"tt2"},[a("span",[t._v("下步工作计划")]),t._v(" "),a("span",[t._v(t._s(e.plan))])]),t._v(" "),a("div",{staticClass:"tt3"},[a("span",[a("i",{staticClass:"dot dot1"},[t._v("·")]),t._v("\n          "+t._s(e.newtime)+"\n        ")]),t._v(" "),a("span",[a("i",{staticClass:"dot dot2"},[t._v("·")]),t._v("\n          "+t._s(e.nexttime)+"\n        ")])]),t._v(" "),a("div",{staticClass:"tt4"},[a("i",{staticClass:"dot dot3"},[t._v("·")]),t._v("\n        "+t._s(e.salename)+"\n      ")])])}),t._v(" "),a("a",{staticClass:"addbtn",attrs:{href:"javascript:;"},on:{click:t.addClueView}},[t._v("+")])],2),t._v(" "),a("div",{staticClass:"listwrap"},[t._m(1),t._v(" "),t._l(t.followData,function(e,s){return a("div",{key:s,staticClass:"box box-red"},[a("div",{staticClass:"tt1"},[a("div",{staticClass:"ww"},[a("el-popover",{attrs:{placement:"bottom",width:"160",trigger:"click"},model:{value:t.followStateVisible,callback:function(e){t.followStateVisible=e},expression:"followStateVisible"}},[a("div",{staticClass:"statelist"},t._l(t.states,function(s,i){return a("a",{key:i,class:e.status==i?"on":"",style:e.status==i?t.backgroundDiv:"",attrs:{href:"javascript:;"},on:{click:t.changeFollowState}},[t._v(t._s(s.name))])})),t._v(" "),a("a",{staticClass:"changebtn",attrs:{slot:"reference",href:"javascript:;"},slot:"reference"},[a("img",{attrs:{src:t.changeimg,alt:""}})])]),t._v(" "),a("p",{on:{click:function(a){t.handleDetailClue(e.id)}}},[t._v(t._s(e.projectname))])],1),t._v(" "),a("a",{staticClass:"visitbtn",attrs:{href:"javascript:;"},on:{click:t.handleVisitRecord}},[a("img",{attrs:{src:t.visitimg,alt:""}})])]),t._v(" "),a("div",{staticClass:"tt2"},[a("span",[t._v(t._s(e.name))]),t._v(" "),a("span",[t._v(t._s(e.phone))])]),t._v(" "),a("div",{staticClass:"tt2"},[a("span",[t._v("下步工作计划")]),t._v(" "),a("span",[t._v(t._s(e.plan))])]),t._v(" "),a("div",{staticClass:"tt3"},[a("span",[a("i",{staticClass:"dot dot1"},[t._v("·")]),t._v("\n          "+t._s(e.newtime)+"\n        ")]),t._v(" "),a("span",[a("i",{staticClass:"dot dot2"},[t._v("·")]),t._v("\n          "+t._s(e.nexttime)+"\n        ")])]),t._v(" "),a("div",{staticClass:"tt4"},[a("i",{staticClass:"dot dot3"},[t._v("·")]),t._v("\n        "+t._s(e.salename)+"\n      ")])])}),t._v(" "),a("a",{staticClass:"addbtn",attrs:{href:"javascript:;"},on:{click:t.addClueView}},[t._v("+")])],2),t._v(" "),a("div",{staticClass:"listwrap"},[t._m(2),t._v(" "),t._l(t.winOrderData,function(e,s){return a("div",{key:s,staticClass:"box box-purple"},[a("div",{staticClass:"tt1"},[a("div",{staticClass:"ww"},[a("el-popover",{attrs:{placement:"bottom",width:"160",trigger:"click"},model:{value:t.winStateVisible,callback:function(e){t.winStateVisible=e},expression:"winStateVisible"}},[a("div",{staticClass:"statelist"},t._l(t.states,function(s,i){return a("a",{key:i,class:e.status==i?"on":"",style:e.status==i?t.backgroundDiv:"",attrs:{href:"javascript:;"},on:{click:t.changeWinState}},[t._v(t._s(s.name))])})),t._v(" "),a("a",{staticClass:"changebtn",attrs:{slot:"reference",href:"javascript:;"},slot:"reference"},[a("img",{attrs:{src:t.changeimg,alt:""}})])]),t._v(" "),a("p",{on:{click:function(a){t.handleDetailClue(e.id)}}},[t._v(t._s(e.projectname))])],1),t._v(" "),a("a",{staticClass:"visitbtn",attrs:{href:"javascript:;"},on:{click:t.handleVisitRecord}},[a("img",{attrs:{src:t.visitimg,alt:""}})])]),t._v(" "),a("div",{staticClass:"tt2"},[a("span",[t._v(t._s(e.name))]),t._v(" "),a("span",[t._v(t._s(e.phone))])]),t._v(" "),a("div",{staticClass:"tt2"},[a("span",[t._v("下步工作计划")]),t._v(" "),a("span",[t._v(t._s(e.plan))])]),t._v(" "),a("div",{staticClass:"tt3"},[a("span",[a("i",{staticClass:"dot dot1"},[t._v("·")]),t._v("\n          "+t._s(e.newtime)+"\n        ")]),t._v(" "),a("span",[a("i",{staticClass:"dot dot2"},[t._v("·")]),t._v("\n          "+t._s(e.nexttime)+"\n        ")])]),t._v(" "),a("div",{staticClass:"tt4"},[a("i",{staticClass:"dot dot3"},[t._v("·")]),t._v("\n        "+t._s(e.salename)+"\n      ")])])}),t._v(" "),a("a",{staticClass:"addbtn",attrs:{href:"javascript:;"},on:{click:t.addClueView}},[t._v("+")])],2),t._v(" "),a("div",{staticClass:"listwrap"},[t._m(3),t._v(" "),t._l(t.overData,function(e,s){return a("div",{key:s,staticClass:"box box-orange"},[a("div",{staticClass:"tt1"},[a("div",{staticClass:"ww"},[a("el-popover",{attrs:{placement:"bottom",width:"160",trigger:"click"},model:{value:t.overStateVisible,callback:function(e){t.overStateVisible=e},expression:"overStateVisible"}},[a("div",{staticClass:"statelist"},t._l(t.states,function(s,i){return a("a",{key:i,class:e.status==i?"on":"",style:e.status==i?t.backgroundDiv:"",attrs:{href:"javascript:;"},on:{click:t.changeOverState}},[t._v(t._s(s.name))])})),t._v(" "),a("a",{staticClass:"changebtn",attrs:{slot:"reference",href:"javascript:;"},slot:"reference"},[a("img",{attrs:{src:t.changeimg,alt:""}})])]),t._v(" "),a("p",{on:{click:function(a){t.handleDetailClue(e.id)}}},[t._v(t._s(e.projectname))])],1),t._v(" "),a("a",{staticClass:"visitbtn",attrs:{href:"javascript:;"},on:{click:t.handleVisitRecord}},[a("img",{attrs:{src:t.visitimg,alt:""}})])]),t._v(" "),a("div",{staticClass:"tt2"},[a("span",[t._v(t._s(e.name))]),t._v(" "),a("span",[t._v(t._s(e.phone))])]),t._v(" "),a("div",{staticClass:"tt2"},[a("span",[t._v("下步工作计划")]),t._v(" "),a("span",[t._v(t._s(e.plan))])]),t._v(" "),a("div",{staticClass:"tt3"},[a("span",[a("i",{staticClass:"dot dot1"},[t._v("·")]),t._v("\n          "+t._s(e.newtime)+"\n        ")]),t._v(" "),a("span",[a("i",{staticClass:"dot dot2"},[t._v("·")]),t._v("\n          "+t._s(e.nexttime)+"\n        ")])]),t._v(" "),a("div",{staticClass:"tt4"},[a("i",{staticClass:"dot dot3"},[t._v("·")]),t._v("\n        "+t._s(e.salename)+"\n      ")])])}),t._v(" "),a("a",{staticClass:"addbtn",attrs:{href:"javascript:;"},on:{click:t.addClueView}},[t._v("+")])],2),t._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"添加拜访记录",visible:t.visitRecordVisible,width:"800px"},on:{"update:visible":function(e){t.visitRecordVisible=e}}},[a("visit-record",{ref:"visitRecordChild",attrs:{visitRecordVisible:t.visitRecordVisible,visitForm:t.visitForm}}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.visitRecordVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.submitVisitRecord()}}},[t._v("保存")])],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"title"},[this._v("\n      潜在机会\n      "),e("span",[this._v("3")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"title"},[this._v("\n      待跟进\n      "),e("span",[this._v("3")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"title"},[this._v("\n      赢单\n      "),e("span",[this._v("3")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"title"},[this._v("\n      完结\n      "),e("span",[this._v("3")])])}]};var V=a("VU/8")(y,D,!1,function(t){a("zr17")},"data-v-9ec62f20",null).exports,A=a("XdAZ"),L={name:"cluepage",components:{clueAdd:g,clueDetail:F,visitRecord:w,clueView:V},data:function(){return{userid:JSON.parse(this.$store.getters.userdata).id,clueViewShow:!1,clueTableShow:!0,visitForm:{},visitRecordVisible:!1,detailClueVisible:!1,clueDetailForm:{},visitList:[],relatelistDetail:[],sorts:[],dtitle:"",dataFormVisible:!1,dataForm:{},savaWord:"",isType:"",options:[{value:0,name:"表格视图",src:"../../../static/images/table.png"},{value:1,name:"任务看板",src:"../../../static/images/view.png"}],viewway:0,filters:{},clueData:[],chanceData:[],followData:[],winOrderData:[],overData:[],states:[],sourceList:[],relatelist:[],clueid:0,helpList:[],cusNameList:[]}},created:function(){this.getAllClueList(),this.getBusSortList(),this.getBusStateList()},methods:{getAllRalateList:function(t){var e=this;h({threadId:t},function(t){null==t.data.obj?e.cusNameList=[]:e.cusNameList=t.data.obj})},getSourceAllList:function(){var t=this;f("",function(e){null==e.data.obj?t.sourceList=[]:t.sourceList=e.data.obj})},getBusStateList:function(){var t=this;Object(A.r)("",function(e){t.states=e.data.obj})},getBusSortList:function(){var t=this;Object(A.q)("",function(e){t.sorts=e.data.obj})},getAllClueList:function(){var t,e,a=this,s=r()({},this.filters);t=s,e=function(t){if(null==t.data.obj||0==t.data.obj.length)a.clueData=[],a.chanceData=[],a.followData=[],a.winOrderData=[],a.overData=[];else{a.clueData=t.data.obj;for(var e=0;e<a.clueData.length;e++)0==a.clueData[e].status?a.chanceData.push(a.clueData[e]):1==a.clueData[e].status?a.followData.push(a.clueData[e]):2==a.clueData[e].status?a.winOrderData.push(a.clueData[e]):3==a.clueData[e].status&&a.overData.push(a.clueData[e])}},d.a.post("/crmThreadManage/searchManageList",m.a.stringify(n()({},t))).then(function(t){e(t)}).catch(function(){})},changeView:function(){0==this.viewway?(this.clueViewShow=!1,this.clueTableShow=!0):1==this.viewway&&(this.clueViewShow=!0,this.clueTableShow=!1)},handleVisitRecord:function(t,e){this.clueid=e,this.getAllRalateList(e),this.visitForm={},this.helpList=[],this.visitRecordVisible=!0},submitVisitRecord:function(){var t=this,e=r()({},this.visitForm),a=this.visitForm.visitId;a=0==a.length?"":a.join(","),e.visitIds=a;var s,i,l=[];if(0==this.helpList.length)l="";else for(var o=0;o<this.helpList.length;o++)l.push(this.helpList[o].id);e.helpIds=l.join(","),e.userId=this.userid,e.threadId=this.clueid,s=e,i=function(e){t.visitRecordVisible=!1,t.$message({message:"添加成功",type:"success"}),t.getAllClueList()},d.a.post("/crmVisitRecord/addVisitRecord",m.a.stringify(n()({},s))).then(function(t){i(t)}).catch(function(){})},handleAdd:function(){this.savaWord="新增",this.dtitle="添加商机",this.dataForm={},this.isType="add",this.relatelist=[],this.getSourceAllList(),this.dataFormVisible=!0,this.$refs.addClueChild.$refs.dataForm.clearValidate()},handleEdit:function(t){this.savaWord="保存",this.dtitle="编辑商机",this.isType="edit",this.clueid=t.id,this.editFuc(this.clueid)},editFuc:function(t){var e=this;this.dataForm={},p({id:t},function(t){var a=t.data.obj;e.dataForm.id=a.id,e.dataForm.adress=a.adress,e.dataForm.bidAmount=a.bidAmount,e.dataForm.businessName=a.businessName,e.dataForm.categoryId=a.categoryId,e.dataForm.frequence=a.frequence,e.dataForm.grossMargin=a.grossMargin,e.dataForm.modelBudget=a.modelBudget,e.dataForm.sellManName=a.sellManName,e.dataForm.sourceName=a.sourceName,e.dataForm.stateId=a.stateId,e.dataForm.modelBudget=a.modelBudget,e.dataForm.tenderTime=a.tenderTime,null==t.data.obj.relatedPersonList?e.relatelist=[]:e.relatelist=t.data.obj.relatedPersonList,e.dataFormVisible=!0,e.$refs.addClueChild.$refs.dataForm.clearValidate()})},submitForm:function(){var t=this;this.$refs.addClueChild.$refs.dataForm.validate(function(e){if(!e)return!1;"add"==t.isType?t.addClueSubmit():"edit"==t.isType?t.editClueSubmit():t.dataFormVisible=!1})},addClueSubmit:function(){var t,e,a,s=this,l=r()({},this.dataForm);l.userId=this.userid,l.relatedPersonList=this.relatelist,l=i()(l),t=l,e=function(t){s.dataFormVisible=!1,s.$message({message:"新增成功",type:"success"}),s.getAllClueList()},d.a.post("/crmThreadManage/add",t,{headers:{"Content-Type":"application/json"}}).then(function(t){e(t)}).catch(function(t){a(t)})},editClueSubmit:function(){var t,e,a,s=this,l=r()({},this.dataForm);l.userId=this.userid,l.relatedPersonList=this.relatelist,l=i()(l),t=l,e=function(t){s.dataFormVisible=!1,s.$message({message:"编辑成功",type:"success"}),s.getAllClueList()},d.a.post("/crmThreadManage/update",t,{headers:{"Content-Type":"application/json"}}).then(function(t){e(t)}).catch(function(t){a(t)})},handleViewDetail:function(t){this.clueid=t;for(var e=0;e<this.clueData.length;e++)if(this.clueData[e].id==this.clueid){this.clueDetailForm=r()({},this.clueData[e]);break}this.relatelistDetail=[{leader:"leader",name:"王磊",phone:"15896584784",position:"java开发工程师",role:"主要负责人"},{leader:"leader",name:"刘隔",phone:"15896584784",position:"java开发工程师",role:"协助"}],this.visitList=[{name:"打更",time:"2019-10-02",aim:"弄过好难看",require:"葛洪还没给",plan:"几根公嗯",matter:"细条个够弄额"},{name:"打更2",time:"2019-10-02",aim:"弄过好难看",require:"葛洪还没给葛洪还没给葛洪还没给葛洪还没给葛洪还没给葛洪还没给葛洪还没给",plan:"几根公嗯",matter:"细条个够弄额"},{name:"打更2",time:"2019-10-02",aim:"弄过好难看",require:"葛洪还没给葛洪还没给葛洪还没给葛洪还没给葛洪还没给葛洪还没给葛洪还没给",plan:"几根公嗯",matter:"细条个够弄额细条个够弄额细条个够弄额细条个够弄额细条个够弄额"}],this.detailClueVisible=!0},detailFuc:function(t){var e=this;p({id:t},function(t){e.clueDetailForm=t.data.obj,null==t.data.obj.relatedPersonList?e.relatelistDetail=[]:e.relatelistDetail=t.data.obj.relatedPersonList,null==t.data.obj.visitRecordList?e.visitList=[]:e.visitList=t.data.obj.visitRecordList})},handleDetail:function(t){this.clueid=t.id,this.detailFuc(this.clueid),this.detailClueVisible=!0},getDatas:function(){this.getAllClueList()},resetForm:function(t){this.$refs[t].resetFields(),this.getAllClueList()},selectChange:function(){this.$forceUpdate()}}},S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mainbox"},[t._m(0),t._v(" "),a("div",{staticClass:"toolbar"},[a("el-form",{ref:"filters",attrs:{inline:!0,model:t.filters,size:"small"}},[a("el-form-item",{attrs:{label:"商机名称：",prop:"businessName"}},[a("el-input",{attrs:{placeholder:"请输入","auto-complete":"off"},model:{value:t.filters.businessName,callback:function(e){t.$set(t.filters,"businessName",e)},expression:"filters.businessName"}})],1),t._v(" "),a("el-form-item",{staticClass:"ww2",attrs:{label:"销售人员：",prop:"sellManName"}},[a("el-input",{attrs:{placeholder:"请输入","auto-complete":"off"},model:{value:t.filters.sellManName,callback:function(e){t.$set(t.filters,"sellManName",e)},expression:"filters.sellManName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"商机状态：",prop:"status"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"全部"},on:{change:t.selectChange},model:{value:t.filters.status,callback:function(e){t.$set(t.filters,"status",e)},expression:"filters.status"}},t._l(t.states,function(t){return a("el-option",{key:t.id,attrs:{label:t.stateName,value:t.id}})}))],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.getDatas}},[t._v("搜索")]),t._v(" "),a("el-button",{on:{click:function(e){t.resetForm("filters")}}},[t._v("重置")])],1),t._v(" "),a("div",{staticClass:"toolbtns"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleAdd}},[t._v("新增")]),t._v(" "),a("el-select",{staticClass:"viewbox",attrs:{placeholder:"请选择"},on:{change:t.changeView},model:{value:t.viewway,callback:function(e){t.viewway=e},expression:"viewway"}},t._l(t.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}},[[a("p",[a("img",{staticStyle:{height:"20px","vertical-align":"middle"},attrs:{src:e.src,alt:""}}),t._v("\n                "+t._s(e.name)+"\n              ")])]],2)}))],1)],1)],1),t._v(" "),t.clueTableShow?a("div",{staticClass:"listcontent"},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",size:"small",data:t.clueData,"highlight-current-row":""}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"businessName",label:"商机名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"clientUserList",label:"客户姓名"},scopedSlots:t._u([{key:"default",fn:function(e){return[null==e.row.clientUserList?a("p"):a("div",t._l(e.row.clientUserList,function(e){return a("p",{key:e.id},[t._v(t._s(e.name))])}))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"sellManName",label:"销售人员"}}),t._v(" "),a("el-table-column",{attrs:{prop:"adress",label:"地址"}}),t._v(" "),a("el-table-column",{attrs:{prop:"telephone",label:"电话号码",width:"106px"}}),t._v(" "),a("el-table-column",{attrs:{prop:"visitTime",label:"最新活动拜访时间",width:"148px"},scopedSlots:t._u([{key:"default",fn:function(e){return[null==e.row.visitTime?a("p"):a("p",[t._v(t._s(t._f("dateformat")(e.row.visitTime,"YYYY-MM-DD")))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"nextTime",label:"下次拜访时间",width:"148px"},scopedSlots:t._u([{key:"default",fn:function(e){return[null==e.row.nextTime?a("p"):a("p",[t._v(t._s(t._f("dateformat")(e.row.nextTime,"YYYY-MM-DD")))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"nextPlan",label:"下步工作计划"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sourceName",label:"商机来源"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{staticClass:"source"},[t._v(t._s(e.row.sourceName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"stateName",label:"商机状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("p",{staticClass:"source"},[t._v(t._s(e.row.stateName))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"192px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){t.handleVisitRecord(e.row,e.row.id)}}},[t._v("新增拜访记录")]),t._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(a){t.handleDetail(e.row)}}},[t._v("详情")]),t._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(a){t.handleEdit(e.row)}}},[t._v("编辑")])]}}])})],1)],1):t._e(),t._v(" "),t.clueViewShow?a("div",{staticClass:"taskview"},[a("clue-view",{attrs:{chanceData:t.chanceData,followData:t.followData,winOrderData:t.winOrderData,overData:t.overData,states:t.states,clueid:t.clueid},on:{"update:chanceData":function(e){t.chanceData=e},"update:followData":function(e){t.followData=e},"update:winOrderData":function(e){t.winOrderData=e},"update:overData":function(e){t.overData=e},"addclue-event":t.handleAdd,"detailclue-event":t.handleViewDetail,"update:clueid":function(e){t.clueid=e}}})],1):t._e(),t._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:t.dtitle,visible:t.dataFormVisible,width:"800px"},on:{"update:visible":function(e){t.dataFormVisible=e}}},[a("clue-add",{ref:"addClueChild",attrs:{dataFormVisible:t.dataFormVisible,dataForm:t.dataForm,relatelist:t.relatelist,states:t.states,sourceList:t.sourceList,sorts:t.sorts,isType:t.isType},on:{"update:dataForm":function(e){t.dataForm=e},"update:relatelist":function(e){t.relatelist=e},"update:sourceList":function(e){t.sourceList=e}}}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.dataFormVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.submitForm("dataForm")}}},[t._v(t._s(t.savaWord))])],1)],1),t._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"商机详情",visible:t.detailClueVisible,width:"1200px"},on:{"update:visible":function(e){t.detailClueVisible=e}}},[a("clue-detail",{ref:"detailClueChild",attrs:{detailClueVisible:t.detailClueVisible,clueDetailForm:t.clueDetailForm,relatelistDetail:t.relatelistDetail,visitList:t.visitList}}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.detailClueVisible=!1}}},[t._v("确定")])],1)],1),t._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"添加拜访记录",visible:t.visitRecordVisible,width:"800px"},on:{"update:visible":function(e){t.visitRecordVisible=e}}},[a("visit-record",{ref:"visitRecordChild",attrs:{visitRecordVisible:t.visitRecordVisible,visitForm:t.visitForm,helpList:t.helpList,userid:t.userid,clueid:t.clueid,cusNameList:t.cusNameList},on:{"update:visitRecordVisible":function(e){t.visitRecordVisible=e},"update:visitForm":function(e){t.visitForm=e},"update:helpList":function(e){t.helpList=e},"update:cusNameList":function(e){t.cusNameList=e}}}),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.visitRecordVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.submitVisitRecord()}}},[t._v("保存")])],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"navtitle"},[e("span",[this._v("线索管理")])])}]};var R=a("VU/8")(L,S,!1,function(t){a("F74f")},"data-v-2f77bfa9",null);e.default=R.exports},dwq1:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAvElEQVRYR+3WsQkDMQwF0H/r5AZIbbzYXXtLpM8QFrjKAFkgS6SzHK5NEZD0wQTs3vzHt4W9YPBaBudjAmYD/9VAKeXovb9zzhtrekwNiMgDwFVVdxbCBKi1XlprdwArC2ECnLWzEWbANwLAllLavXfCBWAi3AAWIgRgIMKAKIIOsI5nGBAdyxAgGn4enxvACHcDWOEuADPcDGCHmwEi8mS+hB7ATVVfrL+AGeB98X7tc48hCzMBs4HhDXwA4eqrIUoOeDcAAAAASUVORK5CYII="},el4L:function(t,e){},pKHR:function(t,e){},zr17:function(t,e){}});
//# sourceMappingURL=2.65c30a310b9607c31b54.js.map